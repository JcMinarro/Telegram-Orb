version: 2.1
orbs:
description: A notification orb for Telegram. Send messages to your Telegram channels
commands:
  notify:
    description: Notify a Telegram channel with a custom message
    parameters:
      message:
        type: string
      telegram-bot-token:
        description: Enter the name of the environment variable storing your Telegram Bot Token
        type: env_var_name
        default: TELEGRAM_BOT_TOKEN
    steps:
      - run:
          name: Telegram Notification
          command: |
            # Provide error if no telegram-bot-token is set and error. Otherwise continue
            if [ -z "$<< parameters.telegram-bot-token >>" ]; then
              echo "No TELEGRAM_BOT_TOKEN set"
              echo "Please input your Telegram Bot Token value into the environment variable called '<< parameters.telegram-bot-token >>'"
              exit 1
            fi
            echo << parameters.message >>